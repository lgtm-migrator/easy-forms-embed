{"version":3,"file":"index.js","sources":["../src/components/EasyFormsEmbed.tsx"],"sourcesContent":["import React from 'react'\r\nimport {FC, useEffect} from 'react'\r\n\r\n\r\ninterface PrefillInfo {\r\n  /**\r\n   * Any info you want to have prefilled as an Object and formated like {text_1: \"value\", text_2: \"value\"}\r\n   */\r\n  [key: string]: any\r\n\r\n}\r\n// this interface is used to prefill the form\r\ninterface Props {\r\n  /**\r\n   * The url of the form\r\n   */\r\n  formUrl: URL,\r\n\r\n  /**\r\n   * Any info you want to have prefilled as an Object and formated like {text_1: \"value\", text_2: \"value\"}\r\n   */\r\n  prefillInfo?: PrefillInfo\r\n}\r\n\r\n\r\nconst EasyFormsEmbed:FC<Props> = ({formUrl, prefillInfo}) => {\r\n  //regex to get ID of form from form link\r\n  let regex = new RegExp('id=.*')\r\n  let match = regex.exec(formUrl.toString())\r\n  const formUrlId = match![0].slice(3)\r\n\r\n  //regex to get appPathUrl from form link\r\n  let appPathUrlRegex: RegExp = new RegExp('www..*/index.php')\r\n  let appPathUrlMatch: RegExpExecArray | null = appPathUrlRegex.exec(formUrl.toString())\r\n  const appPathUrl: string = appPathUrlMatch![0].slice(0,-9)\r\n\r\n  useEffect(() => {\r\n    const scriptElement: any = document.createElement('script')\r\n    const prefillInfoData = prefillInfo\r\n\r\n    const options = {\r\n      // ID of the form\r\n      id: formUrlId,\r\n      theme: 0,\r\n      container: 'c7',\r\n      height: '479px',\r\n      form:\r\n        '//' + appPathUrl + 'index.php?r=app%2Fembed',\r\n      defaultValues: prefillInfoData,\r\n    }\r\n    scriptElement.type = 'text/javascript'\r\n    scriptElement.src =\r\n      'https://' + appPathUrl + 'static_files/js/form.widget.js'\r\n    scriptElement.onload = scriptElement.onreadystatechange = function () {\r\n      const rs = this.readyState\r\n      if (rs) if (rs !== 'complete') if (rs !== 'loaded')\r\n        return\r\n      try {\r\n        // @ts-ignore\r\n        new window.EasyForms().initialize(options).display()\r\n      } catch (e) {\r\n      }\r\n\r\n    }\r\n    const scr = document.getElementsByTagName('script')[0]\r\n    const par: any = scr.parentNode\r\n    par.insertBefore(scriptElement, scr)\r\n  })\r\n\r\n  return (\r\n    <div id=\"c7\">\r\n      Fill in the{' '}\r\n      <a href={formUrl.href}>\r\n        online form\r\n      </a>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default EasyFormsEmbed\r\n"],"names":["useEffect","React"],"mappings":";;;;;;;;IAyBM,cAAc,GAAa,UAAC,EAAsB;QAArB,OAAO,aAAA,EAAE,WAAW,iBAAA;;IAErD,IAAI,KAAK,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,CAAA;IAC/B,IAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAA;IAC1C,IAAM,SAAS,GAAG,KAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;;IAGpC,IAAI,eAAe,GAAW,IAAI,MAAM,CAAC,kBAAkB,CAAC,CAAA;IAC5D,IAAI,eAAe,GAA2B,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAA;IACtF,IAAM,UAAU,GAAW,eAAgB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAA;IAE1DA,eAAS,CAAC;QACR,IAAM,aAAa,GAAQ,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;QAC3D,IAAM,eAAe,GAAG,WAAW,CAAA;QAEnC,IAAM,OAAO,GAAG;;YAEd,EAAE,EAAE,SAAS;YACb,KAAK,EAAE,CAAC;YACR,SAAS,EAAE,IAAI;YACf,MAAM,EAAE,OAAO;YACf,IAAI,EACF,IAAI,GAAG,UAAU,GAAG,yBAAyB;YAC/C,aAAa,EAAE,eAAe;SAC/B,CAAA;QACD,aAAa,CAAC,IAAI,GAAG,iBAAiB,CAAA;QACtC,aAAa,CAAC,GAAG;YACf,UAAU,GAAG,UAAU,GAAG,gCAAgC,CAAA;QAC5D,aAAa,CAAC,MAAM,GAAG,aAAa,CAAC,kBAAkB,GAAG;YACxD,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAA;YAC1B,IAAI,EAAE;gBAAE,IAAI,EAAE,KAAK,UAAU;oBAAE,IAAI,EAAE,KAAK,QAAQ;wBAChD,OAAM;YACR,IAAI;;gBAEF,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,OAAO,EAAE,CAAA;aACrD;YAAC,OAAO,CAAC,EAAE;aACX;SAEF,CAAA;QACD,IAAM,GAAG,GAAG,QAAQ,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;QACtD,IAAM,GAAG,GAAQ,GAAG,CAAC,UAAU,CAAA;QAC/B,GAAG,CAAC,YAAY,CAAC,aAAa,EAAE,GAAG,CAAC,CAAA;KACrC,CAAC,CAAA;IAEF,QACEC,iDAAK,EAAE,EAAC,IAAI;;QACE,GAAG;QACfA,+CAAG,IAAI,EAAE,OAAO,CAAC,IAAI,kBAEjB,CACA,EACP;AACH;;;;"}
{"version":3,"file":"index.js","sources":["../src/components/EasyFormsEmbed.tsx"],"sourcesContent":["import React from 'react'\nimport {FC, useEffect} from 'react'\n\n\ninterface PrefillInfo {\n  /**\n   * Any info you want to have prefilled as an Object and formated like {text_1: \"value\", text_2: \"value\"}\n   */\n  [key: string]: any\n\n}\n// this interface is used to prefill the form\ninterface Props {\n  /**\n   * The url of the form\n   */\n  formUrl: URL,\n\n  /**\n   * A key for the container, otherwise only 1 is possible\n   */\n  key: string,\n  \n  /**\n   * Any info you want to have prefilled as an Object and formated like {text_1: \"value\", text_2: \"value\"}\n   */\n  prefillInfo?: PrefillInfo\n}\n\n\nconst EasyFormsEmbed:FC<Props> = ({formUrl, prefillInfo, key}) => {\n  //regex to get ID of form from form link\n  let regex = new RegExp('id=.*')\n  let match = regex.exec(formUrl.toString())\n  const formUrlId = match![0].slice(3)\n\n  //regex to get appPathUrl from form link\n  let appPathUrlRegex: RegExp = new RegExp('www..*/index.php')\n  let appPathUrlMatch: RegExpExecArray | null = appPathUrlRegex.exec(formUrl.toString())\n  const appPathUrl: string = appPathUrlMatch![0].slice(0,-9)\n\n  useEffect(() => {\n    const scriptElement: any = document.createElement('script')\n    const prefillInfoData = prefillInfo\n\n    const options = {\n      // ID of the form\n      id: formUrlId,\n      theme: 0,\n      container: key,\n      height: '479px',\n      form:\n        '//' + appPathUrl + 'index.php?r=app%2Fembed',\n      defaultValues: prefillInfoData,\n    }\n    scriptElement.type = 'text/javascript'\n    scriptElement.src =\n      'https://' + appPathUrl + 'static_files/js/form.widget.js'\n    scriptElement.onload = scriptElement.onreadystatechange = function () {\n      const rs = this.readyState\n      if (rs) if (rs !== 'complete') if (rs !== 'loaded')\n        return\n      try {\n        // @ts-ignore\n        new window.EasyForms().initialize(options).display()\n      } catch (e) {\n      }\n\n    }\n    const scr = document.getElementsByTagName('script')[0]\n    const par: any = scr.parentNode\n    par.insertBefore(scriptElement, scr)\n  })\n\n  return (\n    <div id={key}>\n      Fill in the{' '}\n      <a href={formUrl.href}>\n        online form\n      </a>\n    </div>\n  )\n}\n\nexport default EasyFormsEmbed\n"],"names":["useEffect","React"],"mappings":";;;;;;;;AA8BM,IAAA,cAAc,GAAa,UAAC,EAA2B,EAAA;AAA1B,IAAA,IAAA,OAAO,aAAA,EAAE,WAAW,GAAA,EAAA,CAAA,WAAA,EAAE,GAAG,GAAA,EAAA,CAAA,GAAA,CAAA;;AAE1D,IAAA,IAAI,KAAK,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,CAAA;IAC/B,IAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAA;IAC1C,IAAM,SAAS,GAAG,KAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;;AAGpC,IAAA,IAAI,eAAe,GAAW,IAAI,MAAM,CAAC,kBAAkB,CAAC,CAAA;IAC5D,IAAI,eAAe,GAA2B,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAA;AACtF,IAAA,IAAM,UAAU,GAAW,eAAgB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAA;AAE1D,IAAAA,eAAS,CAAC,YAAA;QACR,IAAM,aAAa,GAAQ,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;QAC3D,IAAM,eAAe,GAAG,WAAW,CAAA;AAEnC,QAAA,IAAM,OAAO,GAAG;;AAEd,YAAA,EAAE,EAAE,SAAS;AACb,YAAA,KAAK,EAAE,CAAC;AACR,YAAA,SAAS,EAAE,GAAG;AACd,YAAA,MAAM,EAAE,OAAO;AACf,YAAA,IAAI,EACF,IAAI,GAAG,UAAU,GAAG,yBAAyB;AAC/C,YAAA,aAAa,EAAE,eAAe;SAC/B,CAAA;AACD,QAAA,aAAa,CAAC,IAAI,GAAG,iBAAiB,CAAA;AACtC,QAAA,aAAa,CAAC,GAAG;AACf,YAAA,UAAU,GAAG,UAAU,GAAG,gCAAgC,CAAA;AAC5D,QAAA,aAAa,CAAC,MAAM,GAAG,aAAa,CAAC,kBAAkB,GAAG,YAAA;AACxD,YAAA,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAA;AAC1B,YAAA,IAAI,EAAE;gBAAE,IAAI,EAAE,KAAK,UAAU;oBAAE,IAAI,EAAE,KAAK,QAAQ;wBAChD,OAAM;YACR,IAAI;;AAEF,gBAAA,IAAI,MAAM,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,OAAO,EAAE,CAAA;AACrD,aAAA;AAAC,YAAA,OAAO,CAAC,EAAE;AACX,aAAA;AAEH,SAAC,CAAA;QACD,IAAM,GAAG,GAAG,QAAQ,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;AACtD,QAAA,IAAM,GAAG,GAAQ,GAAG,CAAC,UAAU,CAAA;AAC/B,QAAA,GAAG,CAAC,YAAY,CAAC,aAAa,EAAE,GAAG,CAAC,CAAA;AACtC,KAAC,CAAC,CAAA;AAEF,IAAA,QACEC,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA,EAAK,EAAE,EAAE,GAAG,EAAA;;QACE,GAAG;QACfA,yBAAG,CAAA,aAAA,CAAA,GAAA,EAAA,EAAA,IAAI,EAAE,OAAO,CAAC,IAAI,EAEjB,EAAA,aAAA,CAAA,CACA,EACP;AACH;;;;"}